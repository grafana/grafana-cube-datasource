---
title: Git Workflow Rules
description: Rules for git operations, commit strategy, and GitHub CLI usage
alwaysApply: true
---

# Git Workflow Rules

## Git Operations

**In "run everything" Agent mode, avoid interactive commands that require human input.**

- Never use `git rebase -i` (interactive rebase) - it blocks execution waiting for UI input
- Use non-interactive alternatives:
  - `git rebase --onto` to skip specific commits
  - `git reset` + `cherry-pick` to rebuild branches
  - `GIT_SEQUENCE_EDITOR` environment variable for automated rebase editing
- Prefer non-interactive flags and automated approaches

### Examples

✅ **Correct git operations:**
```bash
git rebase --onto base-branch unwanted-commit~1 current-branch
git reset --hard base-branch && git cherry-pick commit1 commit2
```

❌ **Incorrect git operations:**
```bash
git rebase -i base-branch  # Blocks waiting for human input
```

## Commit Strategy

**Prefer atomic commits over amending.**

- Create separate commits for each logical change (e.g., add test, fix bug, refactor)
- Only amend or fixup when explicitly asked by the user
- After completing a commit, new work should go in a new commit
- This preserves the progression of work and makes code review easier

## GitHub CLI

**When updating GitHub PR descriptions, use the REST API instead of `gh pr edit`.**

- The GraphQL-based `gh pr edit` command fails with "Projects (classic) is being deprecated" errors on some repositories
- Use the REST API directly for reliable PR updates

✅ **Correct:**
```bash
gh api repos/OWNER/REPO/pulls/NUMBER -X PATCH -f body='...'
```

❌ **Incorrect:**
```bash
gh pr edit NUMBER --body '...'
```

## Release Process

**Never push version tags before CI passes.**

When creating a release:

1. Create a version bump PR (use `npm version patch --no-git-tag-version`)
2. Wait for CI to pass and merge the PR
3. Only then create and push the tag on main

✅ **Correct release flow:**
```bash
# On a branch - bump version without tag
npm version patch --no-git-tag-version
git add package.json package-lock.json
git commit -m "chore: release vX.Y.Z"
# Create PR, wait for CI, merge

# After merge - tag on main
git checkout main && git pull
git tag vX.Y.Z
git push origin vX.Y.Z
```

❌ **Incorrect:**
```bash
npm version patch  # Creates tag immediately
git push --follow-tags  # Pushes tag before CI validates
```

See the "Releasing" section in README.md for full documentation.
